<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core">

<h:head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <title>JSF Application</title>
    <link rel="stylesheet" href="resources/styles/style.css"/>
    <link rel="icon" href="resources/ico/favicon.ico"/>
</h:head>

<h:body>
    <div class="header gradient-black">Bushmelev Kostya | Group P3218 | Variant 1102</div>
    <h:form id="form">
        <h:outputLabel value="Select X:"/>
        <h:selectOneMenu value="#{pointBean.x}">
            <f:selectItem itemLabel="Select One" itemValue=""/>
            <f:selectItems value="#{pointBean.listOfX}"/>
        </h:selectOneMenu>

        <h:outputLabel value="Select Y:"/>
        <h:inputText value="#{pointBean.y}"/>

        <div class="r-select">
            <h:outputLabel for="r">select r</h:outputLabel> <br/>
            <h:inputText type='hidden' value="#{pointBean.r}" name='r' id='r'/>

            <div id="r-links">
                <h:commandLink value="1" id="rlink1">
                    <f:ajax event="click" onevent="changeR(this, 1)"/>
                </h:commandLink>
                <h:commandLink value="2" id="rlink2">
                    <f:ajax event="click" onevent="changeR(this, 2)"/>
                </h:commandLink>
                <h:commandLink value="3" id="rlink3">
                    <f:ajax event="click" onevent="changeR(this, 3)"/>
                </h:commandLink>
                <h:commandLink value="4" id="rlink4">
                    <f:ajax event="click" onevent="changeR(this, 4)"/>
                </h:commandLink>
                <h:commandLink value="5" id="rlink5">
                    <f:ajax event="click" onevent="changeR(this, 5)"/>
                </h:commandLink>
            </div>
        </div>

        <h:commandButton type="submit" value="Submit" action="#{pointBean.submit()}">
            <f:ajax execute="@form" render="data-table"/>
        </h:commandButton>

        <h:button value="Go to start page" outcome="go-index"/>
    </h:form>

    <div class="view">
        <div class="canvas">
            <canvas id="shedule" class="shedule" width="500" height="500"></canvas>
        </div>

        <div class="data-table" id="main-data-table">
            <h:dataTable value="#{pointBean.points}" var="point" class="data-table" id="data-table">
                <caption class="gradient-red">Таблица результатов запроса</caption>
                <h:column>
                    <f:facet name="header">ID</f:facet>
                    #{point.id}
                </h:column>
                <h:column>
                    <f:facet name="header">x</f:facet>
                    #{point.x}
                </h:column>
                <h:column>
                    <f:facet name="header">y</f:facet>
                    #{point.y}
                </h:column>
                <h:column>
                    <f:facet name="header">R</f:facet>
                    #{point.r}
                </h:column>
            </h:dataTable>
        </div>
    </div>
</h:body>
<input type="hidden" id="R-data"/>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<h:outputScript name="script/draw-canvas.js"/>
<h:outputScript name="script/draw-dot.js"/>
<h:outputScript name="script/draw-dots.js"/>
<h:outputScript name="script/change-r.js"/>
<!--<h:outputScript name="script/send-form.js"/>-->
<!--<h:outputScript name="script/validate-form.js"/>-->
<h:outputScript name="script/touch-shedule.js"/>
<h:outputScript>
    let listX = [];
    let listY = [];
    let listR = [];
    listX = JSON.parse('${pointBean.getListX()}');
    listY = JSON.parse('${pointBean.getListY()}');
    listR = JSON.parse('${pointBean.getListR()}');
    drawDots(listX, listY, listR)
</h:outputScript>
</html>